tau1 =  L_1zz*ddq1 + dq1*fv_1 + fc_1*tanh(100*dq1) + fo_1 - 0.1*(ddq1*l_2z*cos(q2) + l_2x*(-dq1**2*cos(q2)**2 - dq2**2) + l_2y*(-ddq2 + dq1**2*sin(q2)*cos(q2)) + m_2*(-0.1*ddq1*cos(q2) - 9.81*sin(q2)) + (l_3x*(-(dq1*cos(q2) + dq3)**2 - (-dq1*sin(q2)*sin(q3) - dq2*cos(q3))**2) + l_3y*(-ddq1*cos(q2) - ddq3 + dq1*dq2*sin(q2) + (-dq1*sin(q2)*sin(q3) - dq2*cos(q3))*(dq1*sin(q2)*cos(q3) - dq2*sin(q3))) + l_3z*(-ddq2*cos(q3) + dq3*(-dq1*sin(q2)*cos(q3) + dq2*sin(q3)) + (-ddq1*sin(q2) - dq1*dq2*cos(q2))*sin(q3) + (dq1*cos(q2) + dq3)*(dq1*sin(q2)*cos(q3) - dq2*sin(q3))) + m_3*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*sin(q3) + (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*cos(q3)))*cos(q3) - (l_3x*(ddq1*cos(q2) + ddq3 - dq1*dq2*sin(q2) + (-dq1*sin(q2)*sin(q3) - dq2*cos(q3))*(dq1*sin(q2)*cos(q3) - dq2*sin(q3))) + l_3y*(-(dq1*cos(q2) + dq3)**2 - (dq1*sin(q2)*cos(q3) - dq2*sin(q3))**2) + l_3z*(ddq2*sin(q3) - dq3*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3)) - (ddq1*sin(q2) + dq1*dq2*cos(q2))*cos(q3) + (dq1*cos(q2) + dq3)*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3))) + m_3*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*cos(q3) - (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*sin(q3)))*sin(q3))*cos(q2) + (L_2xx*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - L_2yy*dq1*dq2*cos(q2) + L_2zz*dq1*dq2*cos(q2) + 0.1*dq1**2*l_2y - l_2z*(0.1*ddq1*sin(q2) - 9.81*cos(q2)) + (L_3xx*(-ddq2*sin(q3) + dq3*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3)) + (ddq1*sin(q2) + dq1*dq2*cos(q2))*cos(q3)) - L_3yy*(dq1*cos(q2) + dq3)*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3)) + L_3zz*(dq1*cos(q2) + dq3)*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3)) + l_3y*(0.1*ddq1*sin(q2) + 0.25*ddq2 + 0.25*dq1**2*sin(q2)*cos(q2) - 9.81*cos(q2)) - l_3z*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*cos(q3) - (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*sin(q3)))*cos(q3) - (L_3xx*(dq1*cos(q2) + dq3)*(dq1*sin(q2)*cos(q3) - dq2*sin(q3)) + L_3yy*(-ddq2*cos(q3) + dq3*(-dq1*sin(q2)*cos(q3) + dq2*sin(q3)) + (-ddq1*sin(q2) - dq1*dq2*cos(q2))*sin(q3)) + L_3zz*(dq1*cos(q2) + dq3)*(-dq1*sin(q2)*cos(q3) + dq2*sin(q3)) - l_3x*(0.1*ddq1*sin(q2) + 0.25*ddq2 + 0.25*dq1**2*sin(q2)*cos(q2) - 9.81*cos(q2)) + l_3z*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*sin(q3) + (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*cos(q3)))*sin(q3))*sin(q2) + 0.1*(-ddq1*l_2z*sin(q2) + l_2x*(ddq2 + dq1**2*sin(q2)*cos(q2)) + l_2y*(-dq1**2*sin(q2)**2 - dq2**2) + l_3x*(ddq2*cos(q3) - dq3*(-dq1*sin(q2)*cos(q3) + dq2*sin(q3)) - (-ddq1*sin(q2) - dq1*dq2*cos(q2))*sin(q3) + (dq1*cos(q2) + dq3)*(dq1*sin(q2)*cos(q3) - dq2*sin(q3))) + l_3y*(-ddq2*sin(q3) + dq3*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3)) + (ddq1*sin(q2) + dq1*dq2*cos(q2))*cos(q3) + (dq1*cos(q2) + dq3)*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3))) + l_3z*(-(-dq1*sin(q2)*sin(q3) - dq2*cos(q3))**2 - (dq1*sin(q2)*cos(q3) - dq2*sin(q3))**2) + m_2*(0.1*ddq1*sin(q2) - 9.81*cos(q2)) + m_3*(0.1*ddq1*sin(q2) + 0.25*ddq2 + 0.25*dq1**2*sin(q2)*cos(q2) - 9.81*cos(q2)))*sin(q2) + (L_2xx*dq1*dq2*sin(q2) + L_2yy*(ddq1*cos(q2) - dq1*dq2*sin(q2)) - L_2zz*dq1*dq2*sin(q2) - L_3xx*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3))*(dq1*sin(q2)*cos(q3) - dq2*sin(q3)) + L_3yy*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3))*(dq1*sin(q2)*cos(q3) - dq2*sin(q3)) + L_3zz*(ddq1*cos(q2) + ddq3 - dq1*dq2*sin(q2)) - 0.1*dq1**2*l_2x + l_2z*(-0.1*ddq1*cos(q2) - 9.81*sin(q2)) + l_3x*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*cos(q3) - (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*sin(q3)) - l_3y*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*sin(q3) + (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*cos(q3)) + 0.25*(l_3x*(-(dq1*cos(q2) + dq3)**2 - (-dq1*sin(q2)*sin(q3) - dq2*cos(q3))**2) + l_3y*(-ddq1*cos(q2) - ddq3 + dq1*dq2*sin(q2) + (-dq1*sin(q2)*sin(q3) - dq2*cos(q3))*(dq1*sin(q2)*cos(q3) - dq2*sin(q3))) + l_3z*(-ddq2*cos(q3) + dq3*(-dq1*sin(q2)*cos(q3) + dq2*sin(q3)) + (-ddq1*sin(q2) - dq1*dq2*cos(q2))*sin(q3) + (dq1*cos(q2) + dq3)*(dq1*sin(q2)*cos(q3) - dq2*sin(q3))) + m_3*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*sin(q3) + (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*cos(q3)))*sin(q3) + 0.25*(l_3x*(ddq1*cos(q2) + ddq3 - dq1*dq2*sin(q2) + (-dq1*sin(q2)*sin(q3) - dq2*cos(q3))*(dq1*sin(q2)*cos(q3) - dq2*sin(q3))) + l_3y*(-(dq1*cos(q2) + dq3)**2 - (dq1*sin(q2)*cos(q3) - dq2*sin(q3))**2) + l_3z*(ddq2*sin(q3) - dq3*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3)) - (ddq1*sin(q2) + dq1*dq2*cos(q2))*cos(q3) + (dq1*cos(q2) + dq3)*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3))) + m_3*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*cos(q3) - (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*sin(q3)))*cos(q3))*cos(q2) 

tau2 =  -L_2xx*dq1**2*sin(q2)*cos(q2) + L_2yy*dq1**2*sin(q2)*cos(q2) + L_2zz*ddq2 + dq2*fv_2 + fc_2*tanh(100*dq2) + fo_2 + l_2x*(0.1*ddq1*sin(q2) - 9.81*cos(q2)) - l_2y*(-0.1*ddq1*cos(q2) - 9.81*sin(q2)) + 0.25*l_3x*(ddq2*cos(q3) - dq3*(-dq1*sin(q2)*cos(q3) + dq2*sin(q3)) - (-ddq1*sin(q2) - dq1*dq2*cos(q2))*sin(q3) + (dq1*cos(q2) + dq3)*(dq1*sin(q2)*cos(q3) - dq2*sin(q3))) + 0.25*l_3y*(-ddq2*sin(q3) + dq3*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3)) + (ddq1*sin(q2) + dq1*dq2*cos(q2))*cos(q3) + (dq1*cos(q2) + dq3)*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3))) + 0.25*l_3z*(-(-dq1*sin(q2)*sin(q3) - dq2*cos(q3))**2 - (dq1*sin(q2)*cos(q3) - dq2*sin(q3))**2) + 0.25*m_3*(0.1*ddq1*sin(q2) + 0.25*ddq2 + 0.25*dq1**2*sin(q2)*cos(q2) - 9.81*cos(q2)) - (L_3xx*(-ddq2*sin(q3) + dq3*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3)) + (ddq1*sin(q2) + dq1*dq2*cos(q2))*cos(q3)) - L_3yy*(dq1*cos(q2) + dq3)*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3)) + L_3zz*(dq1*cos(q2) + dq3)*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3)) + l_3y*(0.1*ddq1*sin(q2) + 0.25*ddq2 + 0.25*dq1**2*sin(q2)*cos(q2) - 9.81*cos(q2)) - l_3z*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*cos(q3) - (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*sin(q3)))*sin(q3) - (L_3xx*(dq1*cos(q2) + dq3)*(dq1*sin(q2)*cos(q3) - dq2*sin(q3)) + L_3yy*(-ddq2*cos(q3) + dq3*(-dq1*sin(q2)*cos(q3) + dq2*sin(q3)) + (-ddq1*sin(q2) - dq1*dq2*cos(q2))*sin(q3)) + L_3zz*(dq1*cos(q2) + dq3)*(-dq1*sin(q2)*cos(q3) + dq2*sin(q3)) - l_3x*(0.1*ddq1*sin(q2) + 0.25*ddq2 + 0.25*dq1**2*sin(q2)*cos(q2) - 9.81*cos(q2)) + l_3z*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*sin(q3) + (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*cos(q3)))*cos(q3) 

tau3 =  -L_3xx*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3))*(dq1*sin(q2)*cos(q3) - dq2*sin(q3)) + L_3yy*(-dq1*sin(q2)*sin(q3) - dq2*cos(q3))*(dq1*sin(q2)*cos(q3) - dq2*sin(q3)) + L_3zz*(ddq1*cos(q2) + ddq3 - dq1*dq2*sin(q2)) + dq3*fv_3 + fc_3*tanh(100*dq3) + fo_3 + l_3x*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*cos(q3) - (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*sin(q3)) - l_3y*(-(-0.25*ddq1*cos(q2) + 0.1*dq1**2 + 0.5*dq1*dq2*sin(q2))*sin(q3) + (-0.1*ddq1*cos(q2) - 0.25*dq1**2*cos(q2)**2 - 0.25*dq2**2 - 9.81*sin(q2))*cos(q3)) 

